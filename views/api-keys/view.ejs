<!-- Path: /views/api-keys/view.ejs -->
<%- include('../partials/header', { 
    title: title || 'API Key Details',
    includeChartJS: false
}) %>
<%- include('../partials/navigation', { 
    activeMenu: 'api-keys',
    user: typeof user !== 'undefined' ? user : null
}) %>

<!-- Main Content -->
<main class="flex-1 py-4 sm:py-8">
    <div class="mx-auto max-w-full px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl mx-auto">
        
        <div class="bg-white shadow-xl rounded-xl overflow-hidden">
            <!-- Header -->
            <div class="bg-gradient-to-r from-ruxchai-blue to-blue-700 px-6 py-8 text-white">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center text-3xl mr-4">
                            <i class="fas fa-key text-white text-3xl drop-shadow-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-white">
                                <%= apiKey.app_name %>
                            </h3>
                            <p class="mt-1 text-sm text-blue-100">
                                API Key Details
                            </p>
                        </div>
                    </div>
                    <div class="flex space-x-3">
                        <a href="/api-keys/<%= apiKey.api_key_id %>/edit" class="bg-ruxchai-blue text-white px-4 py-2 rounded-lg hover:bg-ruxchai-blue-dark transition-colors font-medium">
                            <i class="fas fa-edit mr-2"></i>
                            แก้ไข
                        </a>
                        <a href="/api-keys" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors font-medium">
                            <i class="fas fa-arrow-left mr-2"></i>
                            ย้อนกลับ
                        </a>
                    </div>
                </div>
            </div>
            <div class="p-6 bg-gradient-to-br from-gray-50 to-indigo-50">
                <dl class="grid grid-cols-1 gap-6 sm:grid-cols-2">
                    <div class="detail-card detail-card-blue">
                        <dt class="detail-label">
                            <div class="detail-icon detail-icon-blue">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            Application Name
                        </dt>
                        <dd class="detail-value">
                            <%= apiKey.app_name %>
                        </dd>
                    </div>
                    
                    <div class="detail-card detail-card-emerald">
                        <dt class="detail-label">
                            <div class="detail-icon detail-icon-emerald">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            Description
                        </dt>
                        <dd class="detail-value">
                            <%= apiKey.description %>
                        </dd>
                    </div>
                    
                    <div class="detail-card detail-card-purple">
                        <dt class="detail-label">
                            <div class="detail-icon detail-icon-purple">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            Permissions
                        </dt>
                        <dd class="mt-1">
                            <% if (apiKey.permissions === 'read') { %>
                                <span class="status-badge status-badge-blue">
                                    <i class="fas fa-eye mr-2"></i>Read Only
                                </span>
                            <% } else if (apiKey.permissions === 'write') { %>
                                <span class="status-badge status-badge-orange">
                                    <i class="fas fa-edit mr-2"></i>Write Only
                                </span>
                            <% } else { %>
                                <span class="status-badge status-badge-green">
                                    <i class="fas fa-check-circle mr-2"></i>Read & Write
                                </span>
                            <% } %>
                        </dd>
                    </div>
                    
                    <div class="detail-card detail-card-orange">
                        <dt class="detail-label">
                            <div class="detail-icon detail-icon-orange">
                                <i class="fas fa-toggle-on"></i>
                            </div>
                            Status
                        </dt>
                        <dd class="detail-value">
                            <% if (apiKey.is_active) { %>
                                <span class="status-badge status-badge-active">
                                    <i class="fas fa-check-circle"></i>
                                    ใช้งาน
                                </span>
                            <% } else { %>
                                <span class="status-badge status-badge-inactive">
                                    <i class="fas fa-times-circle"></i>
                                    ไม่ใช้งาน
                                </span>
                            <% } %>
                        </dd>
                    </div>
                </dl>
                
                <!-- API Key Section -->
                <div class="mt-8 detail-card detail-card-red">
                    <div class="detail-label mb-4">
                        <div class="detail-icon detail-icon-red">
                            <i class="fas fa-key"></i>
                        </div>
                        API Key (Partial - for security)
                    </div>
                    <div class="mt-1">
                        <div class="flex items-center space-x-3">
                            <input type="text" 
                                   value="<%= apiKey.api_key_hash || apiKey.api_key || '****' %>..." 
                                   readonly
                                   class="flex-1 font-mono text-sm bg-gray-100 p-4 rounded-lg border border-gray-300">
                        </div>
                        <div class="mt-4 p-4 bg-yellow-100 rounded-lg border border-yellow-200">
                            <p class="text-sm text-yellow-700 flex items-center">
                                <i class="fas fa-info-circle text-lg mr-2"></i>
                                For security reasons, the full API key is only shown once during creation.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <div class="mt-8 flex flex-col sm:flex-row gap-4 sm:justify-between">
            <a href="/api-keys" class="btn btn-gray">
                <i class="fas fa-arrow-left mr-2"></i>
                Back to API Keys
            </a>
            <div class="flex space-x-3">
                <a href="/api-keys/<%= apiKey.api_key_id %>/edit" class="btn btn-amber">
                    <i class="fas fa-edit mr-2"></i>
                    Edit API Key
                </a>
                <a href="/docs" class="btn btn-blue">
                    <i class="fas fa-book mr-2"></i>
                    View API Documentation
                </a>
            </div>
        </div>
        </div>
    </div>
</main>

<%- include('../partials/footer', {
    pageScripts: null
}) %>