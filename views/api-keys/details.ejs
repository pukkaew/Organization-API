<!-- Path: /views/api-keys/details.ejs -->
<%- include('../layouts/main', { 
    title: apiKey.app_name + ' - API Key Details',
    activeMenu: 'api-keys',
    includeChartJS: true,
    body: ` 
    <div class="max-w-full mx-auto">
        <!-- Header with Gradient Background -->
        <div class="bg-gradient-to-r from-violet-600 via-purple-600 to-indigo-700 rounded-xl p-8 text-white mb-8 shadow-xl">
            <div class="md:flex md:items-center md:justify-between">
                <div class="flex-1 min-w-0">
                    <div class="flex items-center mb-3">
                        <div class="w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center text-3xl mr-4">
                            <i class="fas fa-key"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl sm:text-3xl font-bold text-white truncate">
                                <%= apiKey.app_name %>
                            </h2>
                            <p class="mt-1 text-sm text-purple-100">
                                API Key Details and Usage Statistics
                            </p>
                        </div>
                    </div>
                </div>
                <div class="mt-4 flex flex-col sm:flex-row md:mt-0 md:ml-4 space-y-2 sm:space-y-0 sm:space-x-3">
                    <a href="/api-keys/<%= apiKey.api_key_id %>/edit" class="group inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-lg hover:from-emerald-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
                        <i class="fas fa-edit mr-2 transition-transform group-hover:rotate-12"></i>
                        Edit
                    </a>
                    <form method="POST" action="/api-keys/<%= apiKey.api_key_id %>/regenerate" class="inline">
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                        <button type="submit" 
                                onclick="return confirm('Are you sure you want to regenerate this API key? The current key will be deactivated.')"
                                class="group inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg hover:from-yellow-600 hover:to-orange-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
                            <i class="fas fa-sync mr-2 transition-transform group-hover:rotate-180"></i>
                            Regenerate Key
                        </button>
                    </form>
                    <a href="/api-keys" class="group inline-flex items-center justify-center px-6 py-3 bg-white bg-opacity-20 backdrop-blur-sm text-white rounded-lg hover:bg-opacity-30 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl border border-white border-opacity-20">
                        <i class="fas fa-arrow-left mr-2 transition-transform group-hover:-translate-x-1"></i>
                        Back to List
                    </a>
                </div>
            </div>
        </div>

        <!-- API Key Information -->
        <div class="bg-white shadow-xl rounded-xl overflow-hidden mb-8">
            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-6 text-white">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center text-xl mr-3">
                        <i class="fas fa-clipboard"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white">
                        API Key Information
                    </h3>
                </div>
            </div>
            <div class="p-6 bg-gradient-to-br from-gray-50 to-purple-50">
                <dl class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-100 p-6 rounded-xl shadow-lg border border-blue-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            Application Name
                        </dt>
                        <dd class="text-lg font-bold text-gray-900 bg-white px-3 py-2 rounded-lg shadow-sm">
                            <%= apiKey.app_name %>
                        </dd>
                    </div>
                    
                    <div class="bg-gradient-to-br from-emerald-50 to-teal-100 p-6 rounded-xl shadow-lg border border-emerald-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            Description
                        </dt>
                        <dd class="text-sm text-gray-900 bg-white px-3 py-2 rounded-lg shadow-sm">
                            <%= apiKey.description || '-' %>
                        </dd>
                    </div>
                    
                    <div class="bg-gradient-to-br from-purple-50 to-pink-100 p-6 rounded-xl shadow-lg border border-purple-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            Permissions
                        </dt>
                        <dd class="mt-1">
                            <% if (apiKey.permissions === 'read') { %>
                                <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold bg-gradient-to-r from-blue-400 to-indigo-500 text-white shadow-lg">
                                    <i class="fas fa-eye mr-1"></i> Read Only
                                </span>
                            <% } else if (apiKey.permissions === 'write') { %>
                                <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg">
                                    <i class="fas fa-edit mr-1"></i> Write Only
                                </span>
                            <% } else { %>
                                <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg animate-pulse">
                                    <i class="fas fa-check mr-1"></i> Read & Write
                                </span>
                            <% } %>
                        </dd>
                    </div>
                    
                    <div class="bg-gradient-to-br from-cyan-50 to-blue-100 p-6 rounded-xl shadow-lg border border-cyan-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-bolt"></i>
                            </div>
                            Status
                        </dt>
                        <dd class="mt-1">
                            <% if (apiKey.is_active) { %>
                                <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg animate-pulse">
                                    <i class="fas fa-check mr-1"></i> Active
                                </span>
                            <% } else { %>
                                <span class="inline-flex items-center px-4 py-2 rounded-xl text-sm font-bold bg-gradient-to-r from-red-400 to-pink-500 text-white shadow-lg">
                                    <i class="fas fa-times mr-1"></i> Inactive
                                </span>
                            <% } %>
                        </dd>
                    </div>
                    
                    <div class="bg-gradient-to-br from-yellow-50 to-amber-100 p-6 rounded-xl shadow-lg border border-yellow-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-yellow-500 to-amber-600 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-calendar"></i>
                            </div>
                            Created
                        </dt>
                        <dd class="text-sm text-gray-900 bg-white px-3 py-2 rounded-lg shadow-sm">
                            <%= new Date(apiKey.created_date).toLocaleString() %>
                            <% if (apiKey.created_by) { %>
                                <br><span class="text-xs text-gray-600">by <%= apiKey.created_by %></span>
                            <% } %>
                        </dd>
                    </div>
                    
                    <div class="bg-gradient-to-br from-orange-50 to-red-100 p-6 rounded-xl shadow-lg border border-orange-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-clock"></i>
                            </div>
                            Last Used
                        </dt>
                        <dd class="text-sm text-gray-900 bg-white px-3 py-2 rounded-lg shadow-sm">
                            <% if (apiKey.last_used_date) { %>
                                <%= new Date(apiKey.last_used_date).toLocaleString() %>
                            <% } else { %>
                                Never used
                            <% } %>
                        </dd>
                    </div>
                    
                    <div class="bg-gradient-to-br from-rose-50 to-pink-100 p-6 rounded-xl shadow-lg border border-rose-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-rose-500 to-pink-600 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-clock"></i>
                            </div>
                            Expiration
                        </dt>
                        <dd class="text-sm text-gray-900 bg-white px-3 py-2 rounded-lg shadow-sm">
                            <% if (apiKey.expires_date) { %>
                                <%= new Date(apiKey.expires_date).toLocaleDateString() %>
                                <% if (new Date(apiKey.expires_date) < new Date()) { %>
                                    <br><span class="inline-flex items-center px-2 py-1 rounded-lg text-xs font-bold bg-gradient-to-r from-red-400 to-pink-500 text-white shadow-lg mt-1">
                                        Expired
                                    </span>
                                <% } %>
                            <% } else { %>
                                No expiration
                            <% } %>
                        </dd>
                    </div>
                    
                    <% if (apiKey.rate_limit) { %>
                        <div class="bg-gradient-to-br from-teal-50 to-cyan-100 p-6 rounded-xl shadow-lg border border-teal-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                            <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                                <div class="w-8 h-8 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                Rate Limit
                            </dt>
                            <dd class="text-sm text-gray-900 bg-white px-3 py-2 rounded-lg shadow-sm">
                                <%= apiKey.rate_limit %> requests per hour
                            </dd>
                        </div>
                    <% } %>
                    
                    <% if (apiKey.ip_whitelist) { %>
                        <div class="sm:col-span-2 lg:col-span-3 bg-gradient-to-br from-indigo-50 to-violet-100 p-6 rounded-xl shadow-lg border border-indigo-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                            <dt class="text-sm font-medium text-gray-600 flex items-center mb-3">
                                <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-violet-600 rounded-lg flex items-center justify-center mr-3">
                                    <i class="fas fa-lock"></i>
                                </div>
                                IP Whitelist
                            </dt>
                            <dd class="text-xs font-mono bg-white p-4 rounded-lg shadow-sm">
                                <%= apiKey.ip_whitelist.split('\\n').join('<br>') %>
                            </dd>
                        </div>
                    <% } %>
                </dl>
            </div>
        </div>

        <!-- Usage Statistics -->
        <div class="mb-8">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center mr-3">
                    📊
                </div>
                <h3 class="text-2xl font-bold text-gray-900">Usage Statistics</h3>
            </div>
            <div class="grid grid-cols-1 gap-6 sm:grid-cols-3">
                <!-- Last 24 Hours -->
                <div class="bg-gradient-to-br from-blue-50 to-indigo-100 p-6 rounded-xl shadow-lg border border-blue-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-center mb-3">
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <dt class="text-sm font-medium text-gray-600">
                            Last 24 Hours
                        </dt>
                    </div>
                    <dd class="mt-3">
                        <div class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                            <%= stats.last24Hours.total_requests || 0 %>
                        </div>
                        <p class="text-sm text-gray-600 mt-1 bg-white px-2 py-1 rounded-lg shadow-sm">
                            requests • 
                            <% if (stats.last24Hours.total_requests > 0) { %>
                                <span class="text-green-600 font-semibold"><%= ((stats.last24Hours.successful_requests / stats.last24Hours.total_requests) * 100).toFixed(1) %>% success</span>
                            <% } else { %>
                                <span class="text-gray-500">- success</span>
                            <% } %>
                        </p>
                    </dd>
                </div>

                <!-- Last 7 Days -->
                <div class="bg-gradient-to-br from-emerald-50 to-teal-100 p-6 rounded-xl shadow-lg border border-emerald-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-center mb-3">
                        <div class="w-8 h-8 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <dt class="text-sm font-medium text-gray-600">
                            Last 7 Days
                        </dt>
                    </div>
                    <dd class="mt-3">
                        <div class="text-3xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent">
                            <%= stats.last7Days.total_requests || 0 %>
                        </div>
                        <p class="text-sm text-gray-600 mt-1 bg-white px-2 py-1 rounded-lg shadow-sm">
                            requests • 
                            <% if (stats.last7Days.total_requests > 0) { %>
                                <span class="text-blue-600 font-semibold"><%= Math.round(stats.last7Days.avg_response_time) %>ms avg</span>
                            <% } else { %>
                                <span class="text-gray-500">- avg</span>
                            <% } %>
                        </p>
                    </dd>
                </div>

                <!-- Last 30 Days -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-100 p-6 rounded-xl shadow-lg border border-purple-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-center mb-3">
                        <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <dt class="text-sm font-medium text-gray-600">
                            Last 30 Days
                        </dt>
                    </div>
                    <dd class="mt-3">
                        <div class="text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                            <%= stats.last30Days.total_requests || 0 %>
                        </div>
                        <p class="text-sm text-gray-600 mt-1 bg-white px-2 py-1 rounded-lg shadow-sm">
                            requests • 
                            <% if (stats.last30Days.server_errors > 0) { %>
                                <span class="text-red-600 font-semibold"><%= stats.last30Days.server_errors %> errors</span>
                            <% } else { %>
                                <span class="text-green-600 font-semibold">no errors</span>
                            <% } %>
                        </p>
                    </dd>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Hourly Usage Chart -->
            <div class="bg-white shadow-xl rounded-xl overflow-hidden">
                <div class="bg-gradient-to-r from-blue-500 to-indigo-600 px-6 py-4 text-white">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center text-lg mr-3">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <h3 class="text-lg font-bold text-white">
                            Hourly Usage (Today)
                        </h3>
                    </div>
                </div>
                <div class="p-6">
                    <div style="height: 300px;">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Top Endpoints -->
            <div class="bg-white shadow-xl rounded-xl overflow-hidden">
                <div class="bg-gradient-to-r from-emerald-500 to-teal-600 px-6 py-4 text-white">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center text-lg mr-3">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <h3 class="text-lg font-bold text-white">
                            Top Endpoints (Last 7 Days)
                        </h3>
                    </div>
                </div>
                <div class="p-6 bg-gradient-to-br from-gray-50 to-emerald-50">
                    <div class="space-y-4">
                        <% if (endpointStats && endpointStats.length > 0) { %>
                            <% endpointStats.slice(0, 10).forEach(function(endpoint) { %>
                                <div class="bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 border border-gray-100">
                                    <div class="flex items-center justify-between">
                                        <div class="flex-1 min-w-0">
                                            <p class="text-sm font-medium text-gray-900 truncate flex items-center">
                                                <span class="inline-flex items-center px-3 py-1 rounded-lg text-xs font-bold shadow-sm
                                                    <% if (endpoint.method === 'GET') { %>
                                                        bg-gradient-to-r from-blue-400 to-blue-500 text-white
                                                    <% } else if (endpoint.method === 'POST') { %>
                                                        bg-gradient-to-r from-green-400 to-green-500 text-white
                                                    <% } else if (endpoint.method === 'PUT' || endpoint.method === 'PATCH') { %>
                                                        bg-gradient-to-r from-yellow-400 to-yellow-500 text-white
                                                    <% } else if (endpoint.method === 'DELETE') { %>
                                                        bg-gradient-to-r from-red-400 to-red-500 text-white
                                                    <% } else { %>
                                                        bg-gradient-to-r from-gray-400 to-gray-500 text-white
                                                    <% } %>
                                                ">
                                                    <%= endpoint.method %>
                                                </span>
                                                <span class="ml-3 text-gray-700 font-mono text-sm"><%= endpoint.endpoint %></span>
                                            </p>
                                            <div class="mt-2 flex items-center text-xs bg-gray-100 px-3 py-1 rounded-lg">
                                                <span class="text-blue-600 font-semibold"><i class="fas fa-chart-bar mr-1"></i> <%= endpoint.request_count %> requests</span>
                                                <span class="mx-2 text-gray-400">•</span>
                                                <span class="text-green-600 font-semibold"><i class="fas fa-bolt mr-1"></i> <%= Math.round(endpoint.avg_response_time) %>ms avg</span>
                                                <% if (endpoint.error_count > 0) { %>
                                                    <span class="mx-2 text-gray-400">•</span>
                                                    <span class="text-red-600 font-semibold"><i class="fas fa-times mr-1"></i> <%= endpoint.error_count %> errors</span>
                                                <% } %>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <% }); %>
                        <% } else { %>
                            <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                                <div class="text-4xl mb-3"><i class="fas fa-folder-open"></i></div>
                                <p class="text-sm text-gray-500">No endpoint data available</p>
                            </div>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Logs -->
        <div class="bg-white shadow-xl rounded-xl overflow-hidden">
            <div class="bg-gradient-to-r from-violet-500 to-purple-600 px-6 py-6 text-white">
                <div class="flex justify-between items-center">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-white bg-opacity-20 rounded-xl flex items-center justify-center text-xl mr-3">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white">
                            Recent API Logs
                        </h3>
                    </div>
                    <a href="/api-keys/<%= apiKey.api_key_id %>/logs" class="group inline-flex items-center px-4 py-2 bg-white bg-opacity-20 backdrop-blur-sm text-white rounded-lg hover:bg-opacity-30 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl border border-white border-opacity-20">
                        View all logs <i class="fas fa-arrow-right ml-1 transition-transform group-hover:translate-x-1"></i>
                    </a>
                </div>
            </div>
            <div class="border-t border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Timestamp
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Method
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Endpoint
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Status
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Response Time
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    IP Address
                                </th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <% if (recentLogs && recentLogs.length > 0) { %>
                                <% recentLogs.forEach(function(log) { %>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            <%= new Date(log.created_date).toLocaleString() %>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium
                                                <% if (log.method === 'GET') { %>
                                                    bg-blue-100 text-blue-800
                                                <% } else if (log.method === 'POST') { %>
                                                    bg-green-100 text-green-800
                                                <% } else if (log.method === 'PUT' || log.method === 'PATCH') { %>
                                                    bg-yellow-100 text-yellow-800
                                                <% } else if (log.method === 'DELETE') { %>
                                                    bg-red-100 text-red-800
                                                <% } else { %>
                                                    bg-gray-100 text-gray-800
                                                <% } %>
                                            ">
                                                <%= log.method %>
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                            <%= log.endpoint %>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium
                                                <% if (log.response_status >= 200 && log.response_status < 300) { %>
                                                    bg-green-100 text-green-800
                                                <% } else if (log.response_status >= 400 && log.response_status < 500) { %>
                                                    bg-yellow-100 text-yellow-800
                                                <% } else if (log.response_status >= 500) { %>
                                                    bg-red-100 text-red-800
                                                <% } else { %>
                                                    bg-gray-100 text-gray-800
                                                <% } %>
                                            ">
                                                <%= log.response_status %>
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            <%= log.response_time_ms %>ms
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            <%= log.ip_address || '-' %>
                                        </td>
                                    </tr>
                                <% }); %>
                            <% } else { %>
                                <tr>
                                    <td colspan="6" class="px-6 py-4 text-center text-sm text-gray-500">
                                        No logs found
                                    </td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    `,
    pageScripts: `
    <script>
        // Parse hourly stats data
        const hourlyStats = <%- JSON.stringify(hourlyStats) %>;
        
        // Hourly Usage Chart
        const ctx = document.getElementById('hourlyChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: hourlyStats.map(h => h.hour + ':00'),
                datasets: [{
                    label: 'API Requests',
                    data: hourlyStats.map(h => h.request_count),
                    backgroundColor: 'rgba(0, 144, 211, 0.5)',
                    borderColor: 'rgb(0, 144, 211)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                const dataIndex = context.dataIndex;
                                const avgTime = hourlyStats[dataIndex].avg_response_time;
                                return avgTime ? 'Avg response: ' + Math.round(avgTime) + 'ms' : '';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            stepSize: 1
                        }
                    }
                }
            }
        });
    </script>
    `
}) %>